\section{Cu\+R\+N\+D\+Action\+Factory\+Service Class Reference}
\label{classCuHdbActionFactoryService}\index{CuHdbActionFactoryService@{CuHdbActionFactoryService}}


implements Cu\+ServiceI interface and provides a service to register, unregister and find {\itshape Websocket actions}  




{\ttfamily \#include $<$cuhdbactionfactoryservice.\+h$>$}



Inheritance diagram for Cu\+R\+N\+D\+Action\+Factory\+Service\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=223pt]{classCuHdbActionFactoryService__inherit__graph}
\end{center}
\end{figure}
\subsection*{Public Types}
\begin{DoxyCompactItemize}
\item 
enum \textbf{ Type} \{ \textbf{ Cu\+R\+N\+D\+Action\+Factory\+Service\+Type} = Cu\+Services\+::User + 25
 \}
\end{DoxyCompactItemize}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\textbf{ Cu\+R\+N\+D\+Action\+Factory\+Service} ()
\begin{DoxyCompactList}\small\item\em the class constructor \end{DoxyCompactList}\item 
virtual \textbf{ $\sim$\+Cu\+R\+N\+D\+Action\+Factory\+Service} ()
\item 
\textbf{ Cu\+R\+N\+D\+ActionI} $\ast$ \textbf{ register\+Action} (const std\+::string \&src, const \textbf{ Cu\+R\+N\+D\+Action\+FactoryI} \&f, \textbf{ Cumbia\+Hdb} $\ast$ct)
\begin{DoxyCompactList}\small\item\em Create and register a new action if an action with the same source and type is not already running. \end{DoxyCompactList}\item 
\textbf{ Cu\+R\+N\+D\+ActionI} $\ast$ \textbf{ find\+Active} (const std\+::string \&name, \textbf{ Cu\+R\+N\+D\+Action\+I\+::\+Type} at)
\begin{DoxyCompactList}\small\item\em find an {\itshape active} action given the source name and the action type \end{DoxyCompactList}\item 
std\+::vector$<$ \textbf{ Cu\+R\+N\+D\+ActionI} $\ast$ $>$ \textbf{ find} (const std\+::string \&name, \textbf{ Cu\+R\+N\+D\+Action\+I\+::\+Type} at)
\begin{DoxyCompactList}\small\item\em find an action given its source and type \end{DoxyCompactList}\item 
size\+\_\+t \textbf{ count} () const
\begin{DoxyCompactList}\small\item\em return the number of registered actions \end{DoxyCompactList}\item 
void \textbf{ unregister\+Action} (const std\+::string \&src, \textbf{ Cu\+R\+N\+D\+Action\+I\+::\+Type} at)
\begin{DoxyCompactList}\small\item\em Unregister the action with the given source and type if the action\textquotesingle{}s exiting() method returns true. \end{DoxyCompactList}\item 
void \textbf{ cleanup} ()
\begin{DoxyCompactList}\small\item\em all registered actions are {\bfseries{deleted}} and removed from the service internal list. \end{DoxyCompactList}\item 
std\+::string \textbf{ get\+Name} () const
\begin{DoxyCompactList}\small\item\em returns the service name \end{DoxyCompactList}\item 
Cu\+Services\+::\+Type \textbf{ get\+Type} () const
\begin{DoxyCompactList}\small\item\em returns the service type \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
implements Cu\+ServiceI interface and provides a service to register, unregister and find {\itshape Websocket actions} 

\begin{DoxyNote}{Note}
This service is internally used by \doxyref{Cumbia\+Hdb}{p.}{classCumbiaHdb} and clients of the library should rarely need to use it.
\end{DoxyNote}
This class is a cumbia {\itshape service} (implements get\+Name and get\+Type). It is registered by Cumbia\+Tango at construction time through the cumbia service provider, namely Cu\+Service\+Provider\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{getServiceProvider()->registerService(static\_cast<CuServices::Type> (CuActionFactoryService::CuActionFactoryServiceType), \textcolor{keyword}{new} CuActionFactoryService());}
\end{DoxyCode}


A reference to the service can be obtained through the Cumbia\+::get\+Service\+Provider method\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{CuActionFactoryService *af =}
\DoxyCodeLine{         static\_cast<CuActionFactoryService *>(getServiceProvider()->get(static\_cast<CuServices::Type> (CuActionFactoryService::CuActionFactoryServiceType)));}
\end{DoxyCode}


Through the service provider, the service can be unregistered with Cu\+Service\+Provider\+::unregister\+Service

Once the service is registered, new \doxyref{Cu\+R\+N\+D\+ActionI}{p.}{classCuHdbActionI} (Cu\+T\+Reader, Cu\+T\+Writer) can be added through register\+Action, removed with unregister\+Action and searched with find and find\+Active. The count method returns the number of registered actions.

Tango sources (for readers) and targets (for writers) with the same name and type, share the same \doxyref{Cu\+R\+N\+D\+ActionI}{p.}{classCuHdbActionI}. See the register\+Action documentation for further details. 

\subsection{Member Enumeration Documentation}
\mbox{\label{classCuHdbActionFactoryService_ae9c200e05592d1323e795bae6cd15d61}} 
\index{CuHdbActionFactoryService@{CuHdbActionFactoryService}!Type@{Type}}
\index{Type@{Type}!CuHdbActionFactoryService@{CuHdbActionFactoryService}}
\subsubsection{Type}
{\footnotesize\ttfamily enum \textbf{ Cu\+R\+N\+D\+Action\+Factory\+Service\+::\+Type}}

\begin{DoxyEnumFields}{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{CuHdbActionFactoryServiceType@{CuHdbActionFactoryServiceType}!CuHdbActionFactoryService@{CuHdbActionFactoryService}}\index{CuHdbActionFactoryService@{CuHdbActionFactoryService}!CuHdbActionFactoryServiceType@{CuHdbActionFactoryServiceType}}}\mbox{\label{classCuHdbActionFactoryService_ae9c200e05592d1323e795bae6cd15d61a6da43a600d795598cf20dd9b5f34ae04}} 
Cu\+R\+N\+D\+Action\+Factory\+Service\+Type&\\
\hline

\end{DoxyEnumFields}


\subsection{Constructor \& Destructor Documentation}
\mbox{\label{classCuHdbActionFactoryService_a145a930b0a77d989f91a0aa44b66ae55}} 
\index{CuHdbActionFactoryService@{CuHdbActionFactoryService}!CuHdbActionFactoryService@{CuHdbActionFactoryService}}
\index{CuHdbActionFactoryService@{CuHdbActionFactoryService}!CuHdbActionFactoryService@{CuHdbActionFactoryService}}
\subsubsection{CuHdbActionFactoryService()}
{\footnotesize\ttfamily Cu\+R\+N\+D\+Action\+Factory\+Service\+::\+Cu\+R\+N\+D\+Action\+Factory\+Service (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



the class constructor 

\mbox{\label{classCuHdbActionFactoryService_abdb3ddc1193a3d00d240d42644a35d4b}} 
\index{CuHdbActionFactoryService@{CuHdbActionFactoryService}!````~CuHdbActionFactoryService@{$\sim$CuHdbActionFactoryService}}
\index{````~CuHdbActionFactoryService@{$\sim$CuHdbActionFactoryService}!CuHdbActionFactoryService@{CuHdbActionFactoryService}}
\subsubsection{$\sim$CuHdbActionFactoryService()}
{\footnotesize\ttfamily Cu\+R\+N\+D\+Action\+Factory\+Service\+::$\sim$\+Cu\+R\+N\+D\+Action\+Factory\+Service (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



\subsection{Member Function Documentation}
\mbox{\label{classCuHdbActionFactoryService_ac7f30edec0e06635fb0c9e5c78dafa11}} 
\index{CuHdbActionFactoryService@{CuHdbActionFactoryService}!cleanup@{cleanup}}
\index{cleanup@{cleanup}!CuHdbActionFactoryService@{CuHdbActionFactoryService}}
\subsubsection{cleanup()}
{\footnotesize\ttfamily void Cu\+R\+N\+D\+Action\+Factory\+Service\+::cleanup (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



all registered actions are {\bfseries{deleted}} and removed from the service internal list. 

All references to the registered actions are removed from the service internal list, whether or not \doxyref{Cu\+R\+N\+D\+Action\+I\+::exiting}{p.}{classCuHdbActionI_ab46088db669f92cf08b5f508c466f0ac} returns true

\begin{DoxyNote}{Note}
The action is {\bfseries{deleted}}. 
\end{DoxyNote}
\mbox{\label{classCuHdbActionFactoryService_a094d291712ceb16742f9aa83a78a5f38}} 
\index{CuHdbActionFactoryService@{CuHdbActionFactoryService}!count@{count}}
\index{count@{count}!CuHdbActionFactoryService@{CuHdbActionFactoryService}}
\subsubsection{count()}
{\footnotesize\ttfamily size\+\_\+t Cu\+R\+N\+D\+Action\+Factory\+Service\+::count (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const}



return the number of registered actions 

\begin{DoxyReturn}{Returns}
the number of registered actions.
\end{DoxyReturn}
Actions are added with register\+Action and removed with unregister\+Action \mbox{\label{classCuHdbActionFactoryService_ae545fe2095283cec8aacc83ca3e7bfa6}} 
\index{CuHdbActionFactoryService@{CuHdbActionFactoryService}!find@{find}}
\index{find@{find}!CuHdbActionFactoryService@{CuHdbActionFactoryService}}
\subsubsection{find()}
{\footnotesize\ttfamily std\+::vector$<$ \textbf{ Cu\+R\+N\+D\+ActionI} $\ast$ $>$ Cu\+R\+N\+D\+Action\+Factory\+Service\+::find (\begin{DoxyParamCaption}\item[{const std\+::string \&}]{name,  }\item[{\textbf{ Cu\+R\+N\+D\+Action\+I\+::\+Type}}]{at }\end{DoxyParamCaption})}



find an action given its source and type 


\begin{DoxyParams}{Parameters}
{\em src} & the complete source (target) name (no wildcard) \\
\hline
{\em at} & the action type (Reader, Writer, Att\+Config, ...) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
a list of actions with the given src and type.
\end{DoxyReturn}
\begin{DoxyParagraph}{Note}
Multiple actions can be found with the given src and type. This is likely to happen when a new action is registered, stopped and registered again with the same src in a short time. In this case, we end up with a not active action and an active one with the same src.
\end{DoxyParagraph}
\begin{DoxyParagraph}{Note}
To find active actions (whose stop method hasn\textquotesingle{}t been called yet), use find\+Active 
\end{DoxyParagraph}


Referenced by Cumbia\+Hdb\+::unlink\+Listener().

\mbox{\label{classCuHdbActionFactoryService_ac487e07bfb26a5de7c2dafa1f280de33}} 
\index{CuHdbActionFactoryService@{CuHdbActionFactoryService}!findActive@{findActive}}
\index{findActive@{findActive}!CuHdbActionFactoryService@{CuHdbActionFactoryService}}
\subsubsection{findActive()}
{\footnotesize\ttfamily \textbf{ Cu\+R\+N\+D\+ActionI} $\ast$ Cu\+R\+N\+D\+Action\+Factory\+Service\+::find\+Active (\begin{DoxyParamCaption}\item[{const std\+::string \&}]{name,  }\item[{\textbf{ Cu\+R\+N\+D\+Action\+I\+::\+Type}}]{at }\end{DoxyParamCaption})}



find an {\itshape active} action given the source name and the action type 


\begin{DoxyParams}{Parameters}
{\em src} & the complete source (target) name (no wildcard) \\
\hline
{\em at} & the action type (Reader, Writer, Att\+Config, ...) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the active action with the given src and type.
\end{DoxyReturn}
\begin{DoxyNote}{Note}
An action is {\itshape active} as long as \doxyref{Cu\+R\+N\+D\+Action\+I\+::exiting}{p.}{classCuHdbActionI_ab46088db669f92cf08b5f508c466f0ac} returns false. Usually, an action is marked as {\itshape exiting} when \doxyref{Cu\+R\+N\+D\+Action\+I\+::stop}{p.}{classCuHdbActionI_aeee23f4b1de8187c9bd1635a039c78f4} is called. For example, see Cu\+T\+Reader\+::stop and Cu\+T\+Writer\+::stop An action can be stopped when a data listener is removed, as in Cu\+T\+Reader\+::remove\+Data\+Listener and Cu\+T\+Writer\+::remove\+Data\+Listener. Cu\+T\+Reader\+::remove\+Data\+Listener and Cu\+T\+Writer\+::remove\+Data\+Listener are invoked by Cumbia\+Tango\+::unlink\+Listener. qumbia-\/tango-\/controls \textbf{ Cu\+T\+Controls\+Reader} (\textbf{ Cu\+T\+Controls\+Writer}) and qumbia-\/epics-\/controls \textbf{ Cu\+Ep\+Controls\+Reader} (\textbf{ Cu\+Ep\+Controls\+Writer}) call Cumbia\+Tango\+::unlink\+Listener from within unset\+Source (unset\+Target for writers).
\end{DoxyNote}
This sequence is an example if you ever need to deal with stopping and unregistering an action from a client. 

Referenced by Cumbia\+Hdb\+::add\+Action(), and Cumbia\+Hdb\+::find\+Action().

\mbox{\label{classCuHdbActionFactoryService_a9aaf803617d5ec448a6cd66ef301b00c}} 
\index{CuHdbActionFactoryService@{CuHdbActionFactoryService}!getName@{getName}}
\index{getName@{getName}!CuHdbActionFactoryService@{CuHdbActionFactoryService}}
\subsubsection{getName()}
{\footnotesize\ttfamily std\+::string Cu\+R\+N\+D\+Action\+Factory\+Service\+::get\+Name (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const}



returns the service name 

\begin{DoxyReturn}{Returns}
the constant string \char`\"{}$\ast$\+Cu\+R\+N\+D\+Action\+Factory\+Service\char`\"{} identifying this type of service.
\end{DoxyReturn}
Implements Cu\+Service\+I\+::get\+Name pure virtual method \mbox{\label{classCuHdbActionFactoryService_a59d55ef924d229a0f6321811ebdf47f8}} 
\index{CuHdbActionFactoryService@{CuHdbActionFactoryService}!getType@{getType}}
\index{getType@{getType}!CuHdbActionFactoryService@{CuHdbActionFactoryService}}
\subsubsection{getType()}
{\footnotesize\ttfamily Cu\+Services\+::\+Type Cu\+R\+N\+D\+Action\+Factory\+Service\+::get\+Type (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const}



returns the service type 

\begin{DoxyReturn}{Returns}
the value defined in cuactionfactoryservice.\+h by the {\itshape enum Type} (Cu\+R\+N\+D\+Action\+Factory\+Service\+Type = Cu\+Services\+::\+User + 25)
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\doxyref{Type}{p.}{classCuHdbActionFactoryService_ae9c200e05592d1323e795bae6cd15d61}
\end{DoxySeeAlso}
Implements \doxyref{Cu\+R\+N\+D\+Action\+I\+::get\+Type}{p.}{classCuHdbActionI_a7a026719a912f71eee3cd8a70a843df3} pure virtual method 

References Cu\+R\+N\+D\+Action\+Factory\+Service\+Type.

\mbox{\label{classCuHdbActionFactoryService_a10e0910c10c4461f5f9afda5e318d4ca}} 
\index{CuHdbActionFactoryService@{CuHdbActionFactoryService}!registerAction@{registerAction}}
\index{registerAction@{registerAction}!CuHdbActionFactoryService@{CuHdbActionFactoryService}}
\subsubsection{registerAction()}
{\footnotesize\ttfamily \textbf{ Cu\+R\+N\+D\+ActionI} $\ast$ Cu\+R\+N\+D\+Action\+Factory\+Service\+::register\+Action (\begin{DoxyParamCaption}\item[{const std\+::string \&}]{src,  }\item[{const \textbf{ Cu\+R\+N\+D\+Action\+FactoryI} \&}]{f,  }\item[{\textbf{ Cumbia\+Hdb} $\ast$}]{ct }\end{DoxyParamCaption})}



Create and register a new action if an action with the same source and type is not already running. 

\begin{DoxyParagraph}{Rules}
\begin{DoxyItemize}
\item same source, different \doxyref{Cu\+R\+N\+D\+ActionI}{p.}{classCuHdbActionI} type\+: two distinct actions. \item Share actions of the same type among sources with the same name. \item If an action with the same source and type exists, but is stopping, it is discarded and a new action is created.\end{DoxyItemize}

\end{DoxyParagraph}
\begin{DoxySeeAlso}{See also}
find\+Action 

\doxyref{unregister\+Action}{p.}{classCuHdbActionFactoryService_a549453b5521d03aaf29fc5d20db68a86} 
\end{DoxySeeAlso}


References Cu\+R\+N\+D\+Action\+Factory\+I\+::create(), and Cu\+R\+N\+D\+Action\+Factory\+I\+::get\+Type().



Referenced by Cumbia\+Hdb\+::add\+Action().

\mbox{\label{classCuHdbActionFactoryService_a549453b5521d03aaf29fc5d20db68a86}} 
\index{CuHdbActionFactoryService@{CuHdbActionFactoryService}!unregisterAction@{unregisterAction}}
\index{unregisterAction@{unregisterAction}!CuHdbActionFactoryService@{CuHdbActionFactoryService}}
\subsubsection{unregisterAction()}
{\footnotesize\ttfamily void Cu\+R\+N\+D\+Action\+Factory\+Service\+::unregister\+Action (\begin{DoxyParamCaption}\item[{const std\+::string \&}]{src,  }\item[{\textbf{ Cu\+R\+N\+D\+Action\+I\+::\+Type}}]{at }\end{DoxyParamCaption})}



Unregister the action with the given source and type if the action\textquotesingle{}s exiting() method returns true. 


\begin{DoxyParams}{Parameters}
{\em src} & the complete source name (no wildcards) \\
\hline
{\em at} & the action type (Reader, Writer, Att\+Config, ...)\\
\hline
\end{DoxyParams}
if an action with the given source (target) and type is found and the action is exiting (\doxyref{Cu\+R\+N\+D\+Action\+I\+::exiting}{p.}{classCuHdbActionI_ab46088db669f92cf08b5f508c466f0ac} returns false), it is removed from the internal list of actions.

If \doxyref{Cu\+R\+N\+D\+Action\+I\+::exiting}{p.}{classCuHdbActionI_ab46088db669f92cf08b5f508c466f0ac} returns false, the action is not removed.

\begin{DoxyNote}{Note}
The action is {\bfseries{not deleted}}. Cu\+T\+Reader and Cu\+T\+Writer auto delete themselves from within Cu\+T\+Reader\+::on\+Result and Cu\+T\+Writer\+::on\+Result when the {\itshape exiting} flag is true. 
\end{DoxyNote}


Referenced by Cu\+R\+N\+D\+Action\+Reader\+::on\+Result().



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
\textbf{ cuhdbactionfactoryservice.\+h}\item 
\textbf{ cuhdbactionfactoryservice.\+cpp}\end{DoxyCompactItemize}
